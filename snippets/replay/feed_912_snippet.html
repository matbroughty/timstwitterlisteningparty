<section class="post">
    <script>
        function togglePreview() {
            tourDates = document.getElementById('tour-dates');
            if (tourDates !== null) {
                tourDates.style.display = 'none';
            }
            preview = document.getElementById('track-preview');
            $(preview).slideToggle("slow");
        }
        
        function toggleTourDates(id) {
            if (id > 0) {
                tourDates = document.getElementById('tour-dates');
                tourLoading = document.getElementById('tour-loading');
                preview = document.getElementById('track-preview');
                if (preview !== null) {
                    preview.style.display = 'none';
                }

                if (tourDates.style.display === 'none') {
                    tourLoading.style.display = 'block';
                    $("#tour-dates").load("../../snippets/tours/tour_" + id + "_snippet.html", 
                                        function() {
                                            tourLoading.style.display = 'none';
                                            $("#tour-dates").slideDown("slow");
                                        });
                } else {
                    $("#tour-dates").slideUp("slow", function() {
                        tourDates.innerHTML = '';
                    });
                }
            }
        }
    </script>
        <table>
        <tr>
            <td>                <img src="./img/feed_912.png" alt="Imagine - The Film" style="width:120px;height:120px;padding-right:8px">
                            </td>
            <td><h4 style="text-align:left"><span class="main-colour">John Lennon &amp; Yoko Ono</span><br/><span class="sub-colour">Imagine - The Film</span></h4></td>
        </tr>
    </table>

        <div style="padding-right:3px;margin-top:5px;margin-bottom:5px">
                <a id="tour-button" class="pure-button" onclick="toggleTourDates()" style="margin-top:3px;color:red;display:none"><i class="fas fa-calendar-day" style="color:red;"></i> Tour Dates</a>
    </div>
            <div id="tour-loading" style="display:none">
        <img src="../../img/record-loading.gif" style="width:40px;height:40px;"> Loading...
    </div>
    <div id="tour-dates" style="display:none;margin-bottom:5px">
    </div>
    <script>
        // If the songkick snippet exists, show the tour button
        $.ajax({
            type: 'HEAD',
            url: 'https://timstwitterlisteningparty.com/snippets/tours/tour__snippet.html',
        success: function() {
            document.getElementById('tour-button').style.display = 'inline-block';
        }
        });
    </script>
    <h1 class="content-subhead">Replay Feed</h1>
    <div id="tweet-feed-0" style="border-radius: 15px; border: 1px solid rgb(204, 204, 204); padding: 5px; width: 100%; max-width: 550px; margin-top: 5px;">
        <table style="width:98%;max-width:550px;">
            <tbody>
                <tr>
                    <td style="text-align:left;width:1%;padding-right:7px;vertical-align:top;">
                        <img src="../../img/profile/Tim_Burgess.jpg" alt="CD" style="border-radius:50%;width:45px;height:45px" onerror="this.onerror=null; this.src='../../img/twitter.png'">
                    </td>
                    <td class="main-colour" style="text-align:left;width:100%;"><b>@Tim_Burgess</b><div class="main-colour" style="line-height:1.1em;">
                            The <a href="https://twitter.com/hashtag/TimsTwitterListeningParty" target="_blank">#TimsTwitterListeningParty</a> Replay for the John & Yoko IMAGINE Film will appear here soon after 9pm on 9 September 2021<br/>
                            <img src="../../img/imagine.jpg" style="width:85%;height:85%;" alt="Imagine">
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    <div id="float-button" class="fa-stack" onclick="toggleAutoOff()">
      <i class="fas fa-mobile fa-3x fa-stack-1x"></i>
      <i id="auto-off-cancel" class="fas fa-ban fa-stack-2x" style="display:none;color:red"></i>
    </div>
    <div style="width:100%;display:flex;justify-content:center;">
        <div id ="float-message">
        </div>
    </div>

    <script src="../../js/replay/NoSleep.min.js"></script>
    <script>
        var noSleep = new NoSleep();
        var autoOff = true;
        var showing = false;

        window.onscroll = function(){
            if (/mobile|android|blackberry/i.test(navigator.userAgent) && !showing) {
                var x = document.getElementById("float-button");
                x.className = "show";
                if (!autoOff) {
                    document.getElementById('auto-off-cancel').style.display = 'inline-block';
                }
                showing = true;
                setTimeout(function(){ 
                    x.className = x.className.replace("show", "");
                    showing = false;
                }, 5000);
            }
         };
         
         function toggleAutoOff() {
            autoOff = !autoOff;
            if (autoOff) {
                noSleep.disable();
                document.getElementById('float-message').innerHTML = 
                        '<span>Screen auto-off enabled</span>';
            } else {
                noSleep.enable();
                document.getElementById('float-message').innerHTML = 
                        '<span>Screen auto-off disabled</span>';
            }

            var dispStyle = (autoOff ? 'none' : 'inline-block');
            document.getElementById('auto-off-cancel').style.display = dispStyle;

            var floatMsg = document.getElementById("float-message");
            floatMsg.className = "show";
            setTimeout(function(){ floatMsg.className = floatMsg.className.replace("show", ""); }, 5000);
         }
    </script>
</section>
